<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ì„¸ì¢… MockHome UI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="background.css" />
    <link rel="stylesheet" href="festival.css" />
    <link rel="stylesheet" href="bottomnav.css" />
  </head>
  <body>
    <div class="background">
      <div class="mobile-frame">
        <!-- ìƒë‹¨ ê³ ì • ì˜ì—­ -->
        <div class="fixed-header" style="position: relative">
          <div class="top-bar"></div>
          <div class="close-button" onclick="window.location.href='index.html'">
            <img src="assets/nav/close.svg" alt="ë‹«ê¸° ë²„íŠ¼" />
          </div>
        </div>

        <!-- ë¡œê³  -->
        <img
          src="assets/nav/logo.svg"
          class="semo-icon"
          style="
            width: 66%;
            border-radius: 16px;
            position: relative;
            left: 41px;
            top: -44px;
          "
        />

        <!-- âœ… ìŠ¤í¬ë¡¤ ë˜ëŠ” ì½˜í…ì¸  -->
        <div class="content-scroll">
          <!-- 1. ì§„í–‰ ì¤‘ì¸ ì¶•ì œ í¬ìŠ¤í„° -->
          <div class="main-poster-carousel">
            <div class="carousel-track">
              <img
                src="src/assets/nav/test.svg"
                class="main-poster"
                alt="í…ŒìŠ¤íŠ¸ í¬ìŠ¤í„°"
              />
              <img
                src="src/assets/nav/test.svg"
                class="main-poster"
                alt="í…ŒìŠ¤íŠ¸ í¬ìŠ¤í„°"
              />
            </div>
          </div>

          <!-- 2. ì„¸ì¢…ì‹œ ëŒ€í‘œ ì¶•ì œ ì„¹ì…˜ -->
          <div class="section-title">
            <div class="title-strong">ì„¸ì¢…ì‹œ ëŒ€í‘œ ì¶•ì œ</div>
            <div class="title-desc">ì§€ê¸ˆ ë°”ë¡œ ì¼ì •ì„ í™•ì¸í•´ë³´ì„¸ìš”!</div>
          </div>

          <!-- 3. ì „ì²´ ì¶•ì œ ëª©ë¡ -->
          <div class="festival-card-list">
            <a
              href="festival.info.html?id=1"
              style="text-decoration: none; color: inherit"
            >
              <div class="festival-card">
                <img
                  src="src/assets/nav/test.svg"
                  class="card-poster"
                  alt="í…ŒìŠ¤íŠ¸ í¬ìŠ¤í„°"
                />
                <div class="card-name">ì¶•ì œëª… ì˜ˆì‹œ 1</div>
                <div class="card-period">2025.07.01 ~ 2025.07.10</div>
              </div>
            </a>
            <a
              href="festival.info.html?id=2"
              style="text-decoration: none; color: inherit"
            >
              <div class="festival-card">
                <img
                  src="src/assets/nav/test.svg"
                  class="card-poster"
                  alt="í…ŒìŠ¤íŠ¸ í¬ìŠ¤í„°"
                />
                <div class="card-name">ì¶•ì œëª… ì˜ˆì‹œ 2</div>
                <div class="card-period">2025.07.20 ~ 2025.07.27</div>
              </div>
            </a>
            <a
              href="festival.info.html?id=3"
              style="text-decoration: none; color: inherit"
            >
              <div class="festival-card">
                <img
                  src="src/assets/nav/test.svg"
                  class="card-poster"
                  alt="í…ŒìŠ¤íŠ¸ í¬ìŠ¤í„°"
                />
                <div class="card-name">ì¶•ì œëª… ì˜ˆì‹œ 3</div>
                <div class="card-period">2025.07.20 ~ 2025.07.27</div>
              </div>
            </a>
            <a
              href="festival.info.html?id=4"
              style="text-decoration: none; color: inherit"
            >
              <div class="festival-card">
                <img
                  src="src/assets/nav/test.svg"
                  class="card-poster"
                  alt="í…ŒìŠ¤íŠ¸ í¬ìŠ¤í„°"
                />
                <div class="card-name">ì¶•ì œëª… ì˜ˆì‹œ 4</div>
                <div class="card-period">2025.07.20 ~ 2025.07.27</div>
              </div>
            </a>
            <a
              href="festival.info.html?id=5"
              style="text-decoration: none; color: inherit"
            >
              <div class="festival-card">
                <img
                  src="src/assets/nav/test.svg"
                  class="card-poster"
                  alt="í…ŒìŠ¤íŠ¸ í¬ìŠ¤í„°"
                />
                <div class="card-name">ì¶•ì œëª… ì˜ˆì‹œ 5</div>
                <div class="card-period">2025.07.20 ~ 2025.07.27</div>
              </div>
            </a>
            <a
              href="festival.info.html?id=6"
              style="text-decoration: none; color: inherit"
            >
              <div class="festival-card">
                <img
                  src="src/assets/nav/test.svg"
                  class="card-poster"
                  alt="í…ŒìŠ¤íŠ¸ í¬ìŠ¤í„°"
                />
                <div class="card-name">ì¶•ì œëª… ì˜ˆì‹œ 6</div>
                <div class="card-period">2025.07.20 ~ 2025.07.27</div>
              </div>
            </a>
          </div>
        </div>
        <!-- âœ… content-scroll ë‹«ê¸° -->
      </div>
      <!-- âœ… mobile-frame ë‹«ê¸° -->
    </div>
    <!-- background ë‹«ê¸° -->

    <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="bottom-nav">
      <a class="nav-btn active" href="festival.html">
        <span class="icon-box"
          ><img src="assets/nav/festival.svg" alt="ì¶•ì œ"
        /></span>
        <span class="nav-label">ì¶•ì œ ì •ë³´</span>
      </a>
      <a class="nav-btn" href="https://www.youtube.com/@sejongcity">
        <span class="icon-box"
          ><img src="assets/nav/youtube.svg" alt="ìœ íŠœë¸Œ"
        /></span>
        <span class="nav-label">ì„¸ì¢…ì‹œ ê³µì‹ ìœ íŠœë¸Œ</span>
      </a>
      <a class="nav-btn" href="./src/index.html">
        <span class="icon-box"
          ><img src="assets/nav/trip.svg" alt="ì¶”ì²œ ì½”ìŠ¤"
        /></span>
        <span class="nav-label">ì¶”ì²œ ì½”ìŠ¤</span>
      </a>
    </nav>

    <!-- ìºëŸ¬ì…€ JS -->
    <script>
      // API URL ì„¤ì • - í™˜ê²½ì— ë”°ë¼ ë™ì  ì„¤ì •
      function getApiBaseUrl() {
        // GitHub Pages ë°°í¬ í™˜ê²½ í™•ì¸
        if (window.location.hostname.includes('github.io')) {
          // GitHub Pagesì—ì„œëŠ” Railway ë°°í¬ëœ API ì‚¬ìš©
          return 'https://sejong-festival-api.onrender.com';
        } else if (
          window.location.hostname === 'localhost' ||
          window.location.hostname === '127.0.0.1'
        ) {
          // ë¡œì»¬ ê°œë°œ í™˜ê²½
          return 'http://localhost:8000';
        } else {
          // ê¸°íƒ€ í™˜ê²½ (Railway ë“±)
          return 'https://sejong-festival-api.onrender.com';
        }
      }

      const API_BASE_URL = getApiBaseUrl();
      console.log(`ğŸŒ API Base URL: ${API_BASE_URL}`);

      window.addEventListener('DOMContentLoaded', () => {
        // ìºëŸ¬ì…€ ê¸°ëŠ¥
        const track = document.querySelector('.carousel-track');
        const posters = document.querySelectorAll('.main-poster');
        let current = 0,
          startX = 0,
          deltaX = 0,
          dragging = false;

        function updateCarousel() {
          track.style.transform = `translateX(${-current * 100}vw)`;
        }

        track.addEventListener('touchstart', (e) => {
          if (e.touches.length !== 1) return;
          startX = e.touches[0].clientX;
          dragging = true;
        });
        track.addEventListener('touchmove', (e) => {
          if (!dragging || e.touches.length !== 1) return;
          deltaX = e.touches[0].clientX - startX;
        });
        track.addEventListener('touchend', (e) => {
          if (!dragging) return;
          if (deltaX < -50 && current < posters.length - 1) current++;
          else if (deltaX > 50 && current > 0) current--;
          updateCarousel();
          dragging = false;
          deltaX = 0;
        });

        track.addEventListener('mousedown', (e) => {
          startX = e.clientX;
          dragging = true;
        });
        track.addEventListener('mousemove', (e) => {
          if (!dragging) return;
          deltaX = e.clientX - startX;
        });
        track.addEventListener('mouseup', (e) => {
          if (!dragging) return;
          if (deltaX < -50 && current < posters.length - 1) current++;
          else if (deltaX > 50 && current > 0) current--;
          updateCarousel();
          dragging = false;
          deltaX = 0;
        });

        track.addEventListener('mouseleave', (e) => {
          if (!dragging) return;
          dragging = false;
          deltaX = 0;
        });

        updateCarousel();

        // API ì—°ë™: ì¶•ì œ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadFestivals() {
          try {
            console.log('ğŸª ì¶•ì œ ëª©ë¡ API í˜¸ì¶œ ì¤‘...');
            const response = await fetch(`${API_BASE_URL}/api/festivals`);

            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }

            const festivals = await response.json();
            console.log('âœ… ì¶•ì œ ëª©ë¡ ë¡œë“œ ì™„ë£Œ:', festivals);

            // ì¶•ì œ ì¹´ë“œ ëª©ë¡ ì—…ë°ì´íŠ¸
            updateFestivalCards(festivals);
          } catch (error) {
            console.error('âŒ ì¶•ì œ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
            // API ì‹¤íŒ¨ ì‹œ ê¸°ì¡´ í•˜ë“œì½”ë”©ëœ ë°ì´í„° ìœ ì§€
          }
        }

        // ì¶•ì œ ì¹´ë“œ ëª©ë¡ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateFestivalCards(festivals) {
          const festivalList = document.querySelector('.festival-card-list');

          if (!festivalList || festivals.length === 0) {
            console.log('ì¶•ì œ ë°ì´í„°ê°€ ì—†ê±°ë‚˜ DOM ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
          }

          // ê¸°ì¡´ ì¹´ë“œë“¤ ì œê±°
          festivalList.innerHTML = '';

          // ìƒˆë¡œìš´ ì¶•ì œ ì¹´ë“œë“¤ ìƒì„±
          festivals.forEach((festival, index) => {
            const festivalCard = `
            <a href="festival.info.html?id=${
              festival.id
            }" style="text-decoration:none; color:inherit;">
              <div class="festival-card">
                <img src="${
                  festival.image_url || 'src/assets/nav/test.svg'
                }" class="card-poster" alt="${festival.name}" />
                <div class="card-name">${festival.name}</div>
                <div class="card-period">${
                  festival.date || 'ë‚ ì§œ ì •ë³´ ì—†ìŒ'
                }</div>
              </div>
            </a>
          `;
            festivalList.innerHTML += festivalCard;
          });

          console.log(`ğŸ‰ ${festivals.length}ê°œì˜ ì¶•ì œ ì¹´ë“œ ì—…ë°ì´íŠ¸ ì™„ë£Œ`);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¶•ì œ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        loadFestivals();
      });
    </script>
  </body>
</html>
